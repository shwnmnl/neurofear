
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Approach 2 - Predictive &#8212; Brainhack 2025 Project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ml';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Approach 3 - Representational" href="rsa.html" />
    <link rel="prev" title="Approach 1 - Univariate" href="glm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fearfaces.png" class="logo__image only-light" alt="Brainhack 2025 Project - Home"/>
    <script>document.write(`<img src="_static/fearfaces.png" class="logo__image only-dark" alt="Brainhack 2025 Project - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Brainhack School 2025 Project
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="glm.html">Approach 1 - Univariate</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Approach 2 - Predictive</a></li>
<li class="toctree-l1"><a class="reference internal" href="rsa.html">Approach 3 - Representational</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ml.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Approach 2 - Predictive</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-vs-decoding">Encoding VS Decoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enough-rambling">Enough rambling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-and-fit-firstlevelmodel">Load data and fit FirstLevelModel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-a-mask">Prepare a mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-our-classification-and-regression">Run our classification and regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="approach-2-predictive">
<h1>Approach 2 - Predictive<a class="headerlink" href="#approach-2-predictive" title="Link to this heading">#</a></h1>
<p>Machine learning is usually used to determine the degree to which a set of variables, often called features, is predictive of a given outcome or target. When the features are brain stuff and the target is task- or stimulus-related stuff, it’s called <em>decoding</em>. Conversely, when the target is the brain and the features are other stuff, that’s <em>encoding</em>. But I can never really remember which is which on the fly.</p>
<p>So before jumping into the analysis, I’d like to take the opportunity to go on a bit of a tangent–<em>or maybe more of a prologue since we haven’t started yet</em>–to try to clear things up, mostly for myself. It may nevertheless be at least somewhat informative if you don’t already have a firm grasp on it.</p>
<hr class="docutils" />
<section id="encoding-vs-decoding">
<h2>Encoding VS Decoding<a class="headerlink" href="#encoding-vs-decoding" title="Link to this heading">#</a></h2>
<p>The little story I tell myself is:</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><em>Succesfully <strong>decoding</strong> a pattern of neural activity means predicting what it’s about; solving the puzzle using a secret key (predictive modeling).</em></p>
<p><em><strong>Encoding</strong> is about the kind of stuff in the world that is predictive of the neural activity of a brain.</em></p>
</div>
<p>But this little story still doesn’t do much to convince me that the difference is all that meaningful. If it works one way, shoudn’t it work both ways? What would it mean if not? To gain a better intuition about this, let’s try to reason our way through the following 2 x 2 matrix:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong><span class="math notranslate nohighlight">\(BRAIN\)</span> Predicts <span class="math notranslate nohighlight">\(STUFF\)</span></strong> (GOOD Decoding)</p></th>
<th class="head"><p><strong><span class="math notranslate nohighlight">\(BRAIN\)</span> Does Not Predict <span class="math notranslate nohighlight">\(STUFF\)</span></strong> (BAD Decoding)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong><span class="math notranslate nohighlight">\(STUFF\)</span> Predicts <span class="math notranslate nohighlight">\(BRAIN\)</span></strong> (GOOD Encoding)</p></td>
<td><p><strong>Bidirectional Predictability</strong><br> (Intuitive link between task/stimulus and brain response)</p></td>
<td><p><strong>Partial Encoding</strong><br> (Limited inference of <span class="math notranslate nohighlight">\(X\)</span> from <span class="math notranslate nohighlight">\(Y\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong><span class="math notranslate nohighlight">\(STUFF\)</span> Does Not Predict <span class="math notranslate nohighlight">\(BRAIN\)</span></strong> (BAD Encoding)</p></td>
<td><p><strong>Redundant/Confounding Patterns</strong><br> (Alternative factors drive <span class="math notranslate nohighlight">\(BRAIN\)</span>)</p></td>
<td><p><strong>Complex or Nonlinear Mapping</strong><br> (Low mutual predictability)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>1. <span class="math notranslate nohighlight">\(STUFF\)</span> predicts <span class="math notranslate nohighlight">\(BRAIN\)</span> <em>AND</em> <span class="math notranslate nohighlight">\(BRAIN\)</span> predicts <span class="math notranslate nohighlight">\(STUFF\)</span>: Bidirectional Predictability</strong><br>
This is an ideal scenario which points to a straightforward relationship between input and output. Simple sensory mappings, like specific sound frequencies predictably activating specific neurons in the auditory cortex, where decoding these neurons can accurately reveal the frequency heard. Encoding explains the sensory representation, while decoding can reconstruct or predict stimuli based on neural patterns.</p>
<p><strong>2. <span class="math notranslate nohighlight">\(STUFF\)</span> predicts <span class="math notranslate nohighlight">\(BRAIN\)</span> <em>BUT</em> <span class="math notranslate nohighlight">\(BRAIN\)</span> does not predict <span class="math notranslate nohighlight">\(STUFF\)</span>: Partial Encoding</strong><br>
This scenario means that the brain’s activity may encode some general features of <span class="math notranslate nohighlight">\(STUFF\)</span>, but not in a way that’s directly reversible. For example, emotionally intense scenes in a film reliably activate certain networks, yet the specific scene or emotion can’t be decoded from brain activity alone. It may hint at something like: <em>“Whatever computations the brain is doing are sensitive to <span class="math notranslate nohighlight">\(STUFF\)</span>, but probably use <span class="math notranslate nohighlight">\(STUFF\)</span> in more complex ways than either the structure of <span class="math notranslate nohighlight">\(STUFF\)</span> or the model relating <span class="math notranslate nohighlight">\(STUFF\)</span> to <span class="math notranslate nohighlight">\(BRAIN\)</span> can account for.”</em></p>
<p><strong>3. <span class="math notranslate nohighlight">\(STUFF\)</span> does not predict <span class="math notranslate nohighlight">\(BRAIN\)</span> <em>BUT</em> <span class="math notranslate nohighlight">\(BRAIN\)</span> predicts <span class="math notranslate nohighlight">\(STUFF\)</span>: Redundant/Confounding Patterns</strong><br>
To me, this is the most counterintuitive quadrant. How can you predict the stimulus from brain activity if the stimulus doesn’t reliably cause the activity? It may be that brain activity co-varies with some latent variable that itself co-varies with <span class="math notranslate nohighlight">\(STUFF\)</span>. So decoding works, not because the brain is encoding <span class="math notranslate nohighlight">\(STUFF\)</span> per se, but because the system has learned or internalized regularities that happen to align with <span class="math notranslate nohighlight">\(STUFF\)</span>.</p>
<p><strong>4. <span class="math notranslate nohighlight">\(STUFF\)</span> does not predict <span class="math notranslate nohighlight">\(BRAIN\)</span> <em>AND</em> <span class="math notranslate nohighlight">\(BRAIN\)</span> does not predict <span class="math notranslate nohighlight">\(STUFF\)</span>: Complex or Nonlinear Mapping / Epistemic Blind Spot</strong><br>
This configuration reflects a breakdown in both encoding and decoding, suggesting a mismatch between what we measure and how the brain actually organizes information. Spontaneous thought is a good example: internal experience varies richly, but eludes both prediction from and inference via brain signals. Models fail not just due to noise, but possibly due to deep representational mismatch. This quadrant reminds us that some mappings may be nonlinear, latent, or fundamentally underconstrained given current tools.</p>
<hr class="docutils" />
<p>So no, if it works one way it does not de facto work the other way and the distinction <em>is</em> important in the grander scheme of things when one contends with the <strong>kinds of claims that are licensed by one approach or the other</strong>. In other words, what kinds of questions can each approach reasonably expect to be able to answer?</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>You’re asking mechanistic questions</strong>: <em>“What does this neuron/region respond to?”</em> → <em><strong>Encoding</strong></em></p>
<p><strong>You’re asking inference questions</strong>: <em>“Can I tell what the subject is seeing or intending from their brain activity?”</em> → <em><strong>Decoding</strong></em></p>
</div>
<p>In sum, both approaches can hint at what information is represented in the brain, but one allows for theoretical/mechanistic hypothesization (encoding) whereas the other does not (or so the story goes).</p>
<blockquote>
<div><p><em>If our goal is merely to demonstrate that a brain region contains information about the experimental conditions, then the direction the model should operate in is a technical issue: One direction may be more convenient for capturing the relevant statistical dependencies (e.g. noise correlations among responses), but a model operating in either direction could support the inference that particular information is present in the code. If our goal is to test computational theories, however, then the direction that the model operates in matters, because it determines whether the model can be interpreted as a brain-computational model.<br>- Kriegeskorte &amp; Douglas, 2019</em></p>
</div></blockquote>
</section>
<section id="enough-rambling">
<h2>Enough rambling<a class="headerlink" href="#enough-rambling" title="Link to this heading">#</a></h2>
<p>Let’s get down and dirty.</p>
<p>A lot of the setup for instantiating a machine learning model and running it on neural data is similar to the last step, so I’ll pick up where the differences begin. The first thing is we need the structure the <code class="docutils literal notranslate"><span class="pre">brain_data</span></code> a bit differently to be able to feed it to a machine learning model.</p>
<p>There is no “in principle” correct way to structure/choose features in machine learning, and even less so in neuroscientific machine learning. A common approach, which we’ll reproduce here, is to use flattened beta maps as features. In other words, the outputs of a first level GLM are used as features. As an FYI, some recent work has tried (and succeeded to varying degrees) using features that are “closer” to the original neural signal (i.e. taking the average of the HRF a couple seconds post stimulus presentation). But we’ll stick to the basics for now.</p>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">image</span><span class="p">,</span> <span class="n">masking</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.input_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">LeaveOneGroupOut</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">Ridge</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.glm.first_level</span><span class="w"> </span><span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.masking</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_epi_mask</span><span class="p">,</span> <span class="n">intersect_masks</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.image</span><span class="w"> </span><span class="kn">import</span> <span class="n">resample_to_img</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_mni152_brain_mask</span>
</pre></div>
</div>
</section>
<section id="load-data-and-fit-firstlevelmodel">
<h3>Load data and fit FirstLevelModel<a class="headerlink" href="#load-data-and-fit-firstlevelmodel" title="Link to this heading">#</a></h3>
<p><em>Here, we could in principle use the exact same model as the last step, but for posterity’s sake I’m including this step here again.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fmri_paths</span>  <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ManyFaces/derivatives/sub-09/func/sub-09_task-videos_run-</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">_preproc_space-MNI_bold.nii.gz&quot;</span>
               <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="n">event_paths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ManyFaces/events/sub-09_ses-01_task-video_run-</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">_events.tsv&quot;</span>
               <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="n">betas</span><span class="p">,</span> <span class="n">y_cat</span><span class="p">,</span> <span class="n">y_fear</span><span class="p">,</span> <span class="n">run_id</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">run_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">ev_path</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fmri_paths</span><span class="p">,</span> <span class="n">event_paths</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">fmri_img</span>   <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">load_img</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="n">events_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ev_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">events_raw</span> <span class="o">=</span> <span class="n">events_raw</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;trial_type&quot;</span><span class="p">})</span> 
    <span class="n">events_raw</span><span class="p">[</span><span class="s2">&quot;modulation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">events_raw</span><span class="p">[</span><span class="s2">&quot;rating&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">events_raw</span><span class="p">[</span><span class="s2">&quot;rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># Mean centered, twas recommended somewhere</span>

    <span class="n">glm</span> <span class="o">=</span> <span class="n">FirstLevelModel</span><span class="p">(</span><span class="n">t_r</span><span class="o">=</span><span class="mf">0.867</span><span class="p">,</span> 
                          <span class="n">hrf_model</span><span class="o">=</span><span class="s2">&quot;spm&quot;</span><span class="p">,</span>
                          <span class="n">drift_model</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">,</span>
                          <span class="n">noise_model</span><span class="o">=</span><span class="s1">&#39;ar1&#39;</span><span class="p">,</span>
                          <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">high_pass</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,)</span>
    <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="n">events_raw</span><span class="p">)</span>

    <span class="n">design</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">design_matrices_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="n">trial_cols</span> <span class="o">=</span> <span class="n">design</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;constant&quot;</span><span class="p">]</span> <span class="o">+</span>  
                                     <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">design</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;drift&quot;</span><span class="p">)])</span>

    <span class="c1"># beta maps for every trial</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">trial_cols</span><span class="p">:</span>
        <span class="n">beta_img</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
        <span class="n">betas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta_img</span><span class="p">)</span>

    <span class="n">trial_events</span> <span class="o">=</span> <span class="n">events_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">trial_cols</span><span class="p">)]</span>
    <span class="n">y_cat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">trial_events</span><span class="p">[</span><span class="s2">&quot;trial_type&quot;</span><span class="p">])</span>
    <span class="n">y_fear</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">trial_events</span><span class="p">[</span><span class="s2">&quot;rating&quot;</span><span class="p">])</span>
    <span class="n">run_id</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">run_idx</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">trial_cols</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="prepare-a-mask">
<h3>Prepare a mask<a class="headerlink" href="#prepare-a-mask" title="Link to this heading">#</a></h3>
<p>Using a brain mask is necessary to extract only the meaningful, non-background voxels from each 3D beta image. This reduces each beta map to a 1D vector of relevant values, making the data compatible with machine learning models that expect structured, fixed-size feature arrays.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ref_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">load_img</span><span class="p">(</span><span class="n">fmri_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
<span class="n">mni_mask</span> <span class="o">=</span> <span class="n">load_mni152_brain_mask</span><span class="p">()</span>
<span class="n">resampled_mask</span> <span class="o">=</span> <span class="n">resample_to_img</span><span class="p">(</span><span class="n">mni_mask</span><span class="p">,</span> <span class="n">ref_img</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>

<span class="n">masker</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span>
    <span class="n">mask_img</span><span class="o">=</span><span class="n">resampled_mask</span><span class="p">,</span>
    <span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">standardize</span><span class="o">=</span><span class="s2">&quot;zscore_sample&quot;</span><span class="p">,</span>
    <span class="n">low_pass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">high_pass</span><span class="o">=</span><span class="mf">0.008</span><span class="p">,</span>
    <span class="n">t_r</span><span class="o">=</span><span class="mf">0.867</span>
<span class="p">)</span>

<span class="c1"># fit masker on all beta maps, then transform</span>
<span class="n">masker</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span> <span class="c1"># shape (n_trials, n_voxels)</span>
<span class="n">y_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_cat</span><span class="p">)</span>
<span class="n">y_fear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_fear</span><span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="run-our-classification-and-regression">
<h3>Run our classification and regression<a class="headerlink" href="#run-our-classification-and-regression" title="Link to this heading">#</a></h3>
<p>Oops, I kind of forgot to tell you, but we’re actually building and testing <em>two</em> models: one to predict (classify) the animal category and one to predict (continuously, so regression) the fear ratings. Why? Because why not.</p>
<p><em>I’m leaving hyperparameter tuning and fancy cross-validation aside for the moment so I can stay closer to the “neuro” side of this than the “data science” side, but will definitely pick back up on it in the future.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logo</span> <span class="o">=</span> <span class="n">LeaveOneGroupOut</span><span class="p">()</span>

<span class="c1"># Category classification</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">cat_scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">logo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_cat</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">y_cat</span><span class="p">[</span><span class="n">train</span><span class="p">])</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">test</span><span class="p">])</span>
    <span class="n">cat_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_cat</span><span class="p">[</span><span class="n">test</span><span class="p">],</span> <span class="n">preds</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Category accuracy per left-out run:&quot;</span><span class="p">,</span> <span class="n">cat_scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean accuracy:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cat_scores</span><span class="p">))</span>

<span class="c1"># Fear-rating regression (ridge)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">fear_scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">logo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_fear</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">y_fear</span><span class="p">[</span><span class="n">train</span><span class="p">])</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">test</span><span class="p">])</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change scoring metric for fear regression</span>
<span class="sd">    /alternatively, maybe switch from regression to multiclass classification</span>
<span class="sd">    TBD depending on the sparsity of the ratings</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">fear_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_fear</span><span class="p">[</span><span class="n">test</span><span class="p">],</span> <span class="n">preds</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fear rating R² per left-out run:&quot;</span><span class="p">,</span> <span class="n">fear_scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean R²:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fear_scores</span><span class="p">))</span>
</pre></div>
</div>
<blockquote>
<div><p><em>Output:</em><br>Category accuracy per left-out run: [0.05, 0.15, 0.0]<br>Mean accuracy: 0.06666666666666667<br>Fear rating R² per left-out run: [-36.108291534089524, -234.85262631972967, -3.0725813057054214]<br>Mean R²: -91.34449971984152</p>
</div></blockquote>
<p>These results are frankly <em>terrible</em>, but it is to be expected as machine learning is better suited to much <strong>much</strong> larger datasets.</p>
<p>Another thing that came to mind was to classify the fear ratings, as they are ordinal rather than purely continuous.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fear_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">fear_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">logo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_fear</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="n">fear_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">y_fear</span><span class="p">[</span><span class="n">train</span><span class="p">])</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">fear_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">test</span><span class="p">])</span>
    <span class="n">fear_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_fear</span><span class="p">[</span><span class="n">test</span><span class="p">],</span> <span class="n">preds</span><span class="p">))</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fear rating classification accuracy per left-out run:&quot;</span><span class="p">,</span> <span class="n">fear_scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean accuracy:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fear_scores</span><span class="p">))</span>
</pre></div>
</div>
<blockquote>
<div><p>Fear rating classification accuracy per left-out run: [0.15, 0.35, 0.2]<br>
Mean accuracy: 0.2333333333333333</p>
</div></blockquote>
<p>This is a bit better, and since we have 5 levels of fear, chance performance woul dbe around 20%. However, due to some non-negligeable class imbalance, these results are still pretty lackluster.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_fear</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>[[ 0. 23.]<br>
[ 1. 15.]<br>
[ 2.  8.]<br>
[ 3.  4.]<br>
[ 4. 10.]]</p>
</div></blockquote>
<p>In an ideal scenario, we’d have good predictive ability and would then plot the beta maps against an anatomical brain and basically do the same thing we did in Approach 1, that is to try to figure out if the betas land in brain regions canonically associated with fear. If I return to these anlayses and get something better out of them, you can expect to see a map under this paragraph, but for now we’ll move on to the last approach, RSA.</p>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Kriegeskorte, N., &amp; Douglas, P. K. (2019). <em>Interpreting encoding and decoding models.</em> <strong>Current opinion in neurobiology, 55, 167-179.</strong></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="glm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Approach 1 - Univariate</p>
      </div>
    </a>
    <a class="right-next"
       href="rsa.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Approach 3 - Representational</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-vs-decoding">Encoding VS Decoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enough-rambling">Enough rambling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-and-fit-firstlevelmodel">Load data and fit FirstLevelModel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-a-mask">Prepare a mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-our-classification-and-regression">Run our classification and regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Shawn Manuel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>